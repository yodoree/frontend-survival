# TDD(Test Driven Development)

테스트 주도 개발이다. 켄트 벡이라는 사람이 고안하였다.
작은 단위의 테스트 케이스를 작성하고 이를 통과하는 코드를 추가 작성하는 단계를 반복하여 구현한다.
애자일 방법론 중 하나인 eXtream Programming(XP)의 `Test First` 개념에 기반을 둔 설계를 중요시한다.
켄트 벡이라는 사람은 TDD가 단순한 설계를 장려하고 자신감을 불어넣어 준다고 말한다.

결국 테스트를 위한 개발을 하는 것이라고 이해가 된다.
개발에 앞서 일련의 과정들의 테스트 코드를 입력하고 그에 따른 개발 과정을 거치며 지속적으로 테스트 코드를 추가해 주면서 개발을 진행한다.

## eXtream Programming(XP)

미래에 대한 예측을 최대한 하지 않고 지속적으로 프로토타입을 완성하는 애자일 방법론 중 하나다.
추가 요구사항이 생기더라도 실시간으로 반영할 수 있는 장점이 있다.

## 단위 테스트(unit test)

말 그대로 한 단위, 일반적으로 클래스나 메소드 수준으로 정해지는데
테스트 가능한 가장 작은 것을 실행하여 동작하는지 확인하는 테스트이다.

## TDD의 개발주기

3가지의 단계를 가진다

1. 🟥Red: 먼저 실패하는 테스트 코드를 작성한다.
실패하면 에러가 뜨기 때문에 red가 아닌가 싶다.
가장 간단한 테스트 코드부터, 현재 생각하는 함수의 동작등의 관련한 테스트 코드를 작성한다.

2. 🟩Green: 작성된 테스트 코드를 통과시키기 위한 실제 개발 코드를 작성한다.

3. 🟦Blue: 중복 코드를 제거하는 등의 리팩토링을 수행한다.

## 일반 개발 방싱과 TDD 개발 방식의 비교

### 일반 개발 방식

'요구사항 분석 -> 설계 -> 개발 -> 테스트 -> 배포'의 형태의 개발 주기를 갖는다.
이 방식은 위험성이 존재한다.
요구사항이 분명하지 않을 수 있음 -> 처음부터 완벽한 설계가 불가능하다.
고객의 요구사항이나 디자인의 변경, 수정 등 많은 조건들이 변경됨에 따라 소스코드가 수정되고
하나가 수정되면 다른 것들을 다 테스트 해보아야 하기 때문에 테스트 과정이 길어질 수 있다.
소스코드가 수정이 되면서 불필요한 코드가 남거나 중복이 발생할 우려가 있다.

이럴 경우 코드들의 재사용이 어렵고 유지보수가 용이하지 않다.

### TDD 개발 방식

Test First -> 테스트 코드가 맨 앞의 과정으로 온다.
설계 단계에서 코드를 작성하는 목적을 미리 정하고, 무엇을 테스트를 해야 될지 미리 작성한다.
테스트 코드를 작성하는 도중 발생하는 에러등은 테스트 케이스에 추가하여 설계를 개선할 수 있다.

이후 테스트가 통과된 코드만을 코드 개발 단계에서 실제 코드로 작성한다.

이런 과정을 거치면서 개발을 하면 재설계 및 디버깅 시간의 단축이 된다.
애초에 각 기능 별로 나눠서 테스트 케이스를 모두 작성해 놓았기 때문에 철저하게 기능 별로 모듈화가 진행된다.

단점으로 개발속도가 느려진다고 보통 얘기한다. 하지만 잘 이해가 가지 않는 부분은 어쨋든 배포되기 전에 테스트 과정을 거치는 일반 개발 방식에서의
테스트가 진행되어야 되기 때문에 테스트 과정은 무조건 거쳐야 하고
미리 거치지 않는다고 해야할 테스트들을 안하면 안되기 때문에
같은 품질의 어플리케이션을 만들기 위해서는 TDD를 활용하는게 보다 빠르게 개발가능 하다고 생각한다.
테스트를 대충 큰 기능만 통과시키는 수준으로 작성하지 않는다면 말이다.

## Jest

jest는 페이스북 팀이 개발한 JS testing framework이다.
jest 이전에 자바스크립트 코드를 테스트 하려면 여러가지 테스팅 라이브러리를 조합해서 사용했었다.
그래서 라이브러리 별로 조금씩 다른 api를 가지고 있어 개발자들에게 혼란을 주기도 했다.
jest는 test runner, test matcher, test mock까지 제공해주기 때문에 편리하다.
고 하는데 사실 불편함을 겪어보지 않았기 때문에 편리한 줄은 모르겠다.

### 기본 사용 방법

jest를 설치 한다.

```shell
npm i -D jest
```

package.json 스크립트를 수정해서 jest를 편리하게 실행시키자.

```json
  "scripts": {
    "test": "jest"
  },
// 밑에 껄 사용하면 코드가 변경될때마다 알아서 테스트가 돌아간다.
    "scripts": {
    "test": "jest --watchAll"
  },
```

### Describe - Context - It 패턴

테스트 가독성 측면을 높여주기 위해 사용 하는 것 같다.

- Describe: 테스트할 대상을 명시
- Context: 테스트의 상황이나 조건을 명시
- It: 테스트할 대상이 해야할 행동을 명시

Describe를 사용해 해당 테스트 대상의 테스트 코드들을 하나로 묶고
그 안에서 상황에 따라 context로 또 묶어준다.
이렇게 테스트 코드를 작성하고 돌리면 코드적으로도 테스트 결과도 가독성이 좋아지는 것 같다.